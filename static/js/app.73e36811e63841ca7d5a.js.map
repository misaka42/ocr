{"version":3,"sources":["webpack:///static/js/app.73e36811e63841ca7d5a.js","webpack:///./src/lib.js","webpack:///./src/Canvas.js","webpack:///./src/home.vue","webpack:///./src/identify.vue","webpack:///./src/main.js","webpack:///home.vue","webpack:///identify.vue","webpack:///./src/identify.vue?800f","webpack:///./src/home.vue?7482"],"names":["webpackJsonp","module","exports","config","pen","size","fillStyle","canvas","width","height","window","innerWidth","grid","like","accept","grayThreshold","fontLib","userDraw","convertImageData","data","arr","i","length","push","compareArray","a","b","matched","forEach","v","Math","abs","validPoint","filter","parseFloat","toFixed","combineArray","acc","setSize","cvs","devicePixelRatio","style","clearCanvas","getContext","clearRect","addFont","str","font","undefined","this","_canvas","document","createElement","ctx","textAlign","fillText","area","getAdjustArea","getGridData","drawArea","x","y","value","img","toDataURL","addCustomFont","fixFont","fontLibItem","getAdjustGridData","_ref","compare","step","index","fillRect","drawAreaBorder","_ref2","strokeStyle","lineWidth","strokeRect","getDetectArea","imageData","getImageData","rect","floor","XStart","XEnd","YStart","YEnd","XOffset","YOffset","adjustArea","offset","half","gridData","px","xx","yy","percent","p","initFontLib","String","fromCharCode","findMatch","_this","sort","__webpack_exports__","__webpack_require__","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_classCallCheck__","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_classCallCheck___default","n","__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_createClass__","__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_createClass___default","lib","Element","arguments","canDraw","callback","init","key","addEvent","drawStart","drawEnd","drawing","fn","name","addEventListener","e","call","preventDefault","_line","clearTimeout","_afterDraw","touches","offsetX","pageX","offsetY","pageY","add","stashPop","Line","setTimeout","afterDraw","bind","stash","getAdjustDetectArea","finish","_snapshot","putImageData","ratio","_last","drawLine","drawArc","beginPath","moveTo","lineTo","stroke","arc","PI","fill","Component","Object","defineProperty","__WEBPACK_IMPORTED_MODULE_0_vue__","__WEBPACK_IMPORTED_MODULE_1_vue_router__","__WEBPACK_IMPORTED_MODULE_2__home__","__WEBPACK_IMPORTED_MODULE_2__home___default","__WEBPACK_IMPORTED_MODULE_3__identify__","__WEBPACK_IMPORTED_MODULE_3__identify___default","__WEBPACK_IMPORTED_MODULE_4_normalize_css__","__WEBPACK_IMPORTED_MODULE_5__index_less__","productionTip","use","routes","path","component","router","$mount","__WEBPACK_IMPORTED_MODULE_0__Canvas__","__WEBPACK_IMPORTED_MODULE_1__lib__","__WEBPACK_IMPORTED_MODULE_1__lib___default","STATE_MSG","0","1","2","state","imgSrc","computed","msg","created","mounted","$nextTick","methods","_this2","$refs","_match","match","reset","clear","$router","confirm","__WEBPACK_IMPORTED_MODULE_0__lib__","__WEBPACK_IMPORTED_MODULE_0__lib___default","__WEBPACK_IMPORTED_MODULE_1__Canvas__","list","pickedItem","pick","item","custom","prompt","render","_vm","_h","$createElement","_c","_self","attrs","id","staticClass","to","_v","_l","class","active","on","click","$event","src","alt","_s","directives","rawName","expression","_m","ref","staticRenderFns"],"mappings":"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","file":"static/js/app.73e36811e63841ca7d5a.js","sourcesContent":["webpackJsonp([1],[\n/* 0 */,\n/* 1 */\n/***/ (function(module, exports) {\n\nvar config = {\n  pen: {\n    size: 10,\n    fillStyle: '#000'\n  },\n  canvas: {\n    width: 200,\n    height: 200,\n    size: window.innerWidth > 400 ? 400 : window.innerWidth\n  },\n  grid: 32,\n  like: 0.1,\n  accept: 0.6,\n  grayThreshold: 128\n};\n\nvar fontLib = [];\nvar userDraw = {};\n\nexports.config = config;\nexports.fontLib = fontLib;\nexports.userDraw = userDraw;\n\nexports.convertImageData = function (data) {\n  var arr = [];\n  for (var i = 0; i < data.length; i += 4) {\n    if (data[i + 3] === 0) {\n      arr.push(0);\n      continue;\n    }\n    if (data[i] + data[i + 1] + data[i + 2] > config.grayThreshold * 3) {\n      arr.push(0);\n    } else {\n      arr.push(1);\n    }\n  }\n  return arr;\n};\n\nexports.compareArray = function (a, b) {\n  var matched = 0;\n  a.forEach(function (v, i) {\n    if (v === 0 && b[i] === 0) {\n      return;\n    }\n    if (Math.abs(v - b[i]) < config.like) {\n      matched++;\n    }\n  });\n  var validPoint = a.filter(function (v) {\n    return v > 0;\n  }).length + b.filter(function (v) {\n    return v > 0;\n  }).length;\n  return parseFloat(matched / validPoint).toFixed(4);\n};\n\nexports.combineArray = function (a, b, acc) {\n  acc = acc || 0.5;\n  var arr = [];\n  a.forEach(function (v, i) {\n    arr.push(v * (1 - acc) + b[i] * acc);\n  });\n  return arr;\n};\n\nexports.setSize = function (cvs, size) {\n  cvs.width = size * window.devicePixelRatio;\n  cvs.height = size * window.devicePixelRatio;\n  cvs.style.width = size + 'px';\n  cvs.style.height = size + 'px';\n};\n\nexports.clearCanvas = function (cvs) {\n  cvs.getContext('2d').clearRect(0, 0, cvs.width, cvs.height);\n};\n\nexports.addFont = function (str, font) {\n  if (this._canvas === undefined) {\n    this._canvas = document.createElement('canvas');\n  }\n  var cvs = this._canvas;\n  this.setSize(cvs, config.grid * 4);\n  var ctx = cvs.getContext('2d');\n\n  this.clearCanvas(cvs);\n  ctx.font = '200 ' + cvs.height / 2 + 'px ' + font;\n  ctx.textAlign = 'center';\n  ctx.fillStyle = '#000';\n  ctx.fillText(str, cvs.width / 2, cvs.height / 2);\n\n  var area = this.getAdjustArea(cvs);\n  var data = this.getGridData(cvs, area);\n\n  this.setSize(cvs, area.size);\n  this.drawArea({\n    cvs: cvs,\n    data: data,\n    area: { x: 0, y: 0, size: area.size * window.devicePixelRatio },\n    style: function style(v) {\n      return 'rgba(0, 0, 0, ' + v + ')';\n    }\n  });\n\n  fontLib.push({\n    value: str,\n    data: data,\n    img: cvs.toDataURL(),\n    size: area.size\n  });\n};\n\nexports.addCustomFont = function (value) {\n  var cvs = this._canvas;\n  var data = userDraw.data;\n  this.setSize(cvs, config.canvas.size);\n  this.clearCanvas(cvs);\n  this.drawArea({\n    cvs: cvs,\n    data: data,\n    area: { x: 0, y: 0, size: this._canvas.width },\n    style: function style(v) {\n      return 'rgba(0, 0, 0, ' + v + ')';\n    }\n  });\n\n  fontLib.push({\n    value: value,\n    data: data,\n    img: cvs.toDataURL(),\n    size: config.canvas.size\n  });\n};\n\nexports.fixFont = function (fontLibItem, acc) {\n  var data = this.combineArray(fontLibItem.data, userDraw.data, acc);\n  this.setSize(this._canvas, fontLibItem.size);\n  this.clearCanvas(this._canvas);\n  this.drawArea({\n    cvs: this._canvas,\n    data: data,\n    area: { x: 0, y: 0, size: this._canvas.width },\n    style: function style(v) {\n      return 'rgba(0, 0, 0, ' + v + ')';\n    }\n  });\n  fontLibItem.data = this.getAdjustGridData(this._canvas);\n  this.drawArea({\n    cvs: this._canvas,\n    data: fontLibItem.data,\n    area: { x: 0, y: 0, size: this._canvas.width },\n    style: function style(v) {\n      return 'rgba(0, 0, 0, ' + v + ')';\n    }\n  });\n  fontLibItem.img = this._canvas.toDataURL();\n};\n\nexports.drawArea = function (_ref) {\n  var cvs = _ref.cvs,\n      data = _ref.data,\n      area = _ref.area,\n      style = _ref.style,\n      compare = _ref.compare;\n\n  var ctx = cvs.getContext('2d');\n  this.clearCanvas(cvs);\n  var step = area.size / config.grid;\n  for (var y = 0; y < config.grid; y++) {\n    for (var x = 0; x < config.grid; x++) {\n      var index = x + y * config.grid;\n      if (compare) {\n        ctx.fillStyle = style(data[index], compare[index]);\n      } else {\n        ctx.fillStyle = style(data[index]);\n      }\n      ctx.fillRect(area.x + x * step, area.x + y * step, step, step);\n    }\n  }\n};\n\nexports.drawAreaBorder = function (_ref2) {\n  var cvs = _ref2.cvs,\n      area = _ref2.area,\n      style = _ref2.style;\n\n  var ctx = cvs.getContext('2d');\n  ctx.strokeStyle = style;\n  ctx.lineWidth = 1;\n  ctx.strokeRect(area.x, area.y, area.size, area.size);\n};\n\nexports.getDetectArea = function (cvs) {\n  var imageData = cvs.getContext('2d').getImageData(0, 0, cvs.width, cvs.height);\n  var arr = this.convertImageData(imageData.data);\n  var rect = {};\n\n  arr.forEach(function (v, i) {\n    if (v) {\n      var y = Math.floor(i / cvs.width);\n      var x = Math.floor(i % cvs.width);\n\n      if (rect.XStart === undefined) {\n        rect.XStart = x;\n        rect.XEnd = x;\n        rect.YStart = y;\n        rect.YEnd = y;\n        return;\n      }\n\n      if (x < rect.XStart) {\n        rect.XStart = x;\n      }\n\n      if (x > rect.XEnd) {\n        rect.XEnd = x;\n      }\n\n      if (y < rect.YStart) {\n        rect.YStart = y;\n      }\n\n      if (y > rect.YEnd) {\n        rect.YEnd = y;\n      }\n    }\n  });\n\n  var XOffset = rect.XEnd - rect.XStart;\n  var YOffset = rect.YEnd - rect.YStart;\n\n  if (YOffset >= XOffset) {\n    rect.y = rect.YStart;\n    rect.x = Math.floor(rect.XStart - (YOffset - XOffset) / 2);\n    rect.size = YOffset;\n  }\n\n  if (YOffset < XOffset) {\n    rect.x = rect.XStart;\n    rect.y = Math.floor(rect.YStart - (XOffset - YOffset) / 2);\n    rect.size = XOffset;\n  }\n\n  return rect;\n};\n\nexports.adjustArea = function (rect) {\n  var offset = rect.size % config.grid;\n  if (offset === 0) {\n    return rect;\n  }\n\n  var toFixed = config.grid - offset;\n  var half = Math.floor(toFixed / 2);\n\n  return {\n    x: rect.x - half,\n    y: rect.y - half,\n    size: rect.size + toFixed\n  };\n};\n\nexports.getAdjustArea = function (cvs) {\n  return this.adjustArea(this.getDetectArea(cvs));\n};\n\nexports.getGridData = function (cvs, area) {\n  var imageData = cvs.getContext('2d').getImageData(area.x, area.y, area.size, area.size);\n  var arr = this.convertImageData(imageData.data);\n  var size = area.size;\n  var grid = config.grid;\n  var step = size / grid;\n  var gridData = [];\n  for (var x = 0; x < grid; x++) {\n    for (var y = 0; y < grid; y++) {\n      var px = [];\n      for (var xx = 0; xx < step; xx++) {\n        for (var yy = 0; yy < step; yy++) {\n          px.push(arr[y * step + x * size * step + yy + xx * size]);\n        }\n      }\n      var percent = px.filter(function (p) {\n        return !!p;\n      }).length / px.length;\n      gridData[y + x * grid] = percent > config.accept ? percent : 0;\n    }\n  }\n  return gridData;\n};\n\nexports.getAdjustGridData = function (cvs) {\n  var area = this.getAdjustArea(cvs);\n  return this.getGridData(cvs, area);\n};\n\nexports.initFontLib = function () {\n  if (fontLib.length) {\n    return;\n  }\n  for (var i = 48; i < 91; i++) {\n    if (i > 57 && i < 65) {\n      continue;\n    }\n    this.addFont(String.fromCharCode(i), 'sans-serif');\n  }\n};\n\nexports.findMatch = function (data) {\n  var _this = this;\n\n  fontLib.forEach(function (font) {\n    font.acc = _this.compareArray(data, font.data);\n  });\n  userDraw.data = data;\n  fontLib.sort(function (a, b) {\n    return b.acc - a.acc;\n  });\n  return fontLib[0];\n};\n\n/***/ }),\n/* 2 */,\n/* 3 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_classCallCheck__ = __webpack_require__(19);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_classCallCheck___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_classCallCheck__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_createClass__ = __webpack_require__(20);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_createClass___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_createClass__);\n\n\nvar lib = __webpack_require__(1);\nvar config = lib.config;\n\nvar Element = function () {\n  function Element(cvs) {\n    var size = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : config.canvas.size;\n    var canDraw = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n\n    __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_classCallCheck___default()(this, Element);\n\n    if (cvs === undefined) {\n      cvs = document.createElement('canvas');\n    }\n    this.cvs = cvs;\n    this.size = size;\n    this.canDraw = canDraw;\n    this.callback = {};\n    this.init(cvs);\n  }\n\n  __WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_createClass___default()(Element, [{\n    key: 'init',\n    value: function init(cvs) {\n      lib.setSize(cvs, this.size);\n      if (!this.canDraw) {\n        return;\n      }\n      this.addEvent(['mousedown', 'touchstart'], this.drawStart);\n      this.addEvent(['mouseup', 'mouseleave', 'mouseenter', 'touchend'], this.drawEnd);\n      this.addEvent(['mousemove', 'touchmove'], this.drawing);\n    }\n  }, {\n    key: 'addEvent',\n    value: function addEvent(arr, fn) {\n      var _this = this;\n\n      arr.forEach(function (name) {\n        _this.cvs.addEventListener(name, function (e) {\n          fn.call(_this, e);\n          e.preventDefault();\n        });\n      });\n    }\n  }, {\n    key: 'drawing',\n    value: function drawing(e) {\n      if (!this._line) {\n        return;\n      }\n      clearTimeout(this._afterDraw);\n      if (e.touches && e.touches[0]) {\n        e.offsetX = e.touches[0].pageX;\n        e.offsetY = e.touches[0].pageY;\n      }\n      this._line.add(e.offsetX, e.offsetY);\n    }\n  }, {\n    key: 'drawStart',\n    value: function drawStart() {\n      this.stashPop();\n      this._line = new Line(this.cvs);\n    }\n  }, {\n    key: 'drawEnd',\n    value: function drawEnd() {\n      this._line = null;\n      this._afterDraw = setTimeout(this.afterDraw.bind(this), 600);\n    }\n  }, {\n    key: 'afterDraw',\n    value: function afterDraw() {\n      this.stash();\n      var area = this.getAdjustDetectArea();\n      var data = lib.getGridData(this.cvs, area);\n      this.callback.finish && this.callback.finish(data);\n      lib.drawAreaBorder({\n        cvs: this.cvs,\n        area: area,\n        style: 'rgba(255, 0, 0, 0.5)'\n      });\n    }\n  }, {\n    key: 'stash',\n    value: function stash() {\n      this._snapshot = this.cvs.getContext('2d').getImageData(0, 0, this.cvs.width, this.cvs.height);\n    }\n  }, {\n    key: 'stashPop',\n    value: function stashPop() {\n      if (!this._snapshot) {\n        return;\n      }\n      this.cvs.getContext('2d').putImageData(this._snapshot, 0, 0);\n      this._snapshot = null;\n    }\n  }, {\n    key: 'clear',\n    value: function clear() {\n      this._snapshot = null;\n      lib.clearCanvas(this.cvs);\n    }\n  }, {\n    key: 'getDetectArea',\n    value: function getDetectArea() {\n      return lib.getDetectArea(this.cvs);\n    }\n  }, {\n    key: 'getAdjustDetectArea',\n    value: function getAdjustDetectArea() {\n      return lib.getAdjustArea(this.cvs);\n    }\n  }]);\n\n  return Element;\n}();\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Element);\n\nvar Line = function () {\n  function Line(cvs) {\n    __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_classCallCheck___default()(this, Line);\n\n    this.cvs = cvs;\n    this.ctx = cvs.getContext('2d');\n    this.ratio = window.devicePixelRatio;\n  }\n\n  __WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_createClass___default()(Line, [{\n    key: 'add',\n    value: function add(x, y) {\n      x *= this.ratio;\n      y *= this.ratio;\n      if (this._last) {\n        this.drawLine(this._last, { x: x, y: y });\n      }\n      this.drawArc(x, y);\n      this._last = { x: x, y: y };\n    }\n  }, {\n    key: 'drawLine',\n    value: function drawLine(p, n) {\n      this.ctx.beginPath();\n      this.ctx.moveTo(p.x, p.y);\n      this.ctx.lineTo(n.x, n.y);\n      this.ctx.lineWidth = config.pen.size * 2;\n      this.ctx.strokeStyle = config.pen.fillStyle;\n      this.ctx.stroke();\n    }\n  }, {\n    key: 'drawArc',\n    value: function drawArc(x, y) {\n      this.ctx.beginPath();\n      this.ctx.arc(x, y, config.pen.size, 0, Math.PI * 2);\n      this.ctx.fillStyle = config.pen.fillStyle;\n      this.ctx.fill();\n    }\n  }]);\n\n  return Line;\n}();\n\n/***/ }),\n/* 4 */,\n/* 5 */,\n/* 6 */,\n/* 7 */,\n/* 8 */,\n/* 9 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar Component = __webpack_require__(8)(\n  /* script */\n  __webpack_require__(16),\n  /* template */\n  __webpack_require__(33),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar Component = __webpack_require__(8)(\n  /* script */\n  __webpack_require__(17),\n  /* template */\n  __webpack_require__(32),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n/***/ }),\n/* 13 */,\n/* 14 */,\n/* 15 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_vue__ = __webpack_require__(14);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_vue_router__ = __webpack_require__(13);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__home__ = __webpack_require__(11);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__home___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2__home__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__identify__ = __webpack_require__(12);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__identify___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3__identify__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_normalize_css__ = __webpack_require__(9);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_normalize_css___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_normalize_css__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__index_less__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__index_less___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5__index_less__);\n\n\n\n\n\n\n\n\n\n\n__WEBPACK_IMPORTED_MODULE_0_vue__[\"a\" /* default */].config.productionTip = false;\n\n__WEBPACK_IMPORTED_MODULE_0_vue__[\"a\" /* default */].use(__WEBPACK_IMPORTED_MODULE_1_vue_router__[\"a\" /* default */]);\n\nvar routes = [{ path: '/', component: __WEBPACK_IMPORTED_MODULE_2__home___default.a }, { path: '/identify', component: __WEBPACK_IMPORTED_MODULE_3__identify___default.a }];\n\nvar router = new __WEBPACK_IMPORTED_MODULE_1_vue_router__[\"a\" /* default */]({\n  routes: routes\n});\n\nnew __WEBPACK_IMPORTED_MODULE_0_vue__[\"a\" /* default */]({\n  router: router\n}).$mount('#app');\n\n/***/ }),\n/* 16 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Canvas__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__lib__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__lib___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1__lib__);\n\n\n\n\n\nvar config = __WEBPACK_IMPORTED_MODULE_1__lib___default.a.config;\n\nvar STATE_MSG = {\n  0: '正在初始化数据...',\n  1: '在上方画布开始绘画',\n  2: '识别是否准确？'\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  data: function data() {\n    return {\n      state: 0,\n      fontLib: __WEBPACK_IMPORTED_MODULE_1__lib___default.a.fontLib,\n      imgSrc: ''\n    };\n  },\n\n  computed: {\n    msg: function msg() {\n      if (this.state === 2) {\n        return '\\u300C ' + this.fontLib[0].value + ' \\u300D ' + STATE_MSG[this.state];\n      }\n      return STATE_MSG[this.state];\n    }\n  },\n  created: function created() {\n    var _this = this;\n\n    setTimeout(function () {\n      __WEBPACK_IMPORTED_MODULE_1__lib___default.a.initFontLib();\n      _this.state = 1;\n    }, 0);\n  },\n  mounted: function mounted() {\n    this.$nextTick(this.init);\n  },\n\n  methods: {\n    init: function init() {\n      var _this2 = this;\n\n      this._canvas = new __WEBPACK_IMPORTED_MODULE_0__Canvas__[\"a\" /* default */](this.$refs.cvs);\n      this._match = new __WEBPACK_IMPORTED_MODULE_0__Canvas__[\"a\" /* default */](this.$refs.match, config.grid * 4, false);\n\n      this._canvas.callback.finish = function (data) {\n        _this2.state = 2;\n        var matched = __WEBPACK_IMPORTED_MODULE_1__lib___default.a.findMatch(data);\n        __WEBPACK_IMPORTED_MODULE_1__lib___default.a.setSize(_this2.$refs.img, config.grid * 4);\n        _this2.imgSrc = matched.img;\n\n        __WEBPACK_IMPORTED_MODULE_1__lib___default.a.drawArea({\n          cvs: _this2.$refs.match,\n          data: data,\n          area: { x: 0, y: 0, size: _this2.$refs.match.width },\n          compare: matched.data,\n          style: function style(a, b) {\n            if (a === 0 && b > 0) {\n              return 'rgba(255, 0, 0, ' + b / 2 + ')';\n            }\n            if (b === 0 && a > 0) {\n              return 'rgba(0, 0, 0, ' + a + ')';\n            }\n            if (a === 0 && b === 0) {\n              return '#fff';\n            }\n            return 'rgba(0, 255, 0, ' + (1 - Math.abs(a - b)) + ')';\n          }\n        });\n      };\n    },\n    reset: function reset() {\n      this.state = 1;\n      this._canvas.clear();\n      this.$router.push({ path: '/identify' });\n    },\n    confirm: function confirm() {\n      this.state = 1;\n      this._canvas.clear();\n      __WEBPACK_IMPORTED_MODULE_1__lib___default.a.fixFont(this.fontLib[0], 0.1);\n    }\n  }\n});\n\n/***/ }),\n/* 17 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__lib__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__lib___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__lib__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Canvas__ = __webpack_require__(3);\n\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  data: function data() {\n    return {\n      list: __WEBPACK_IMPORTED_MODULE_0__lib___default.a.fontLib,\n      pickedItem: null\n    };\n  },\n\n\n  methods: {\n    pick: function pick(item) {\n      if (this.pickedItem === item) {\n        this.pickedItem = null;\n      } else {\n        this.pickedItem = item;\n        var cvs = new __WEBPACK_IMPORTED_MODULE_1__Canvas__[\"a\" /* default */](this.$refs.cvs, 200);\n        __WEBPACK_IMPORTED_MODULE_0__lib___default.a.drawArea({\n          cvs: cvs.cvs,\n          data: __WEBPACK_IMPORTED_MODULE_0__lib___default.a.userDraw.data,\n          compare: item.data,\n          area: { x: 0, y: 0, size: cvs.cvs.width },\n          style: function style(a, b) {\n            if (a === 0 && b > 0) {\n              return 'rgba(255, 0, 0, ' + b / 2 + ')';\n            }\n            if (b === 0 && a > 0) {\n              return 'rgba(0, 0, 0, ' + a + ')';\n            }\n            if (a === 0 && b === 0) {\n              return '#fff';\n            }\n            return 'rgba(0, 255, 0, ' + (1 - Math.abs(a - b)) + ')';\n          }\n        });\n      }\n    },\n    confirm: function confirm() {\n      __WEBPACK_IMPORTED_MODULE_0__lib___default.a.fixFont(this.pickedItem, 0.5);\n      this.pickedItem = null;\n      this.$router.push({ path: '/' });\n    },\n    reset: function reset() {\n      this.pickedItem = null;\n    },\n    custom: function custom() {\n      __WEBPACK_IMPORTED_MODULE_0__lib___default.a.addCustomFont(window.prompt('给你画的东西起个名字吧'));\n    }\n  }\n});\n\n/***/ }),\n/* 18 */,\n/* 19 */,\n/* 20 */,\n/* 21 */,\n/* 22 */,\n/* 23 */,\n/* 24 */,\n/* 25 */,\n/* 26 */,\n/* 27 */,\n/* 28 */,\n/* 29 */,\n/* 30 */,\n/* 31 */,\n/* 32 */\n/***/ (function(module, exports) {\n\nmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    attrs: {\n      \"id\": \"Identify\"\n    }\n  }, [_c('div', {\n    staticClass: \"title\"\n  }, [_c('router-link', {\n    attrs: {\n      \"to\": \"/\"\n    }\n  }, [_vm._v(\"返回\")]), _vm._v(\"选择你想画的图形\")], 1), _vm._v(\" \"), _c('div', {\n    staticClass: \"imgs\"\n  }, _vm._l((_vm.list), function(item) {\n    return _c('div', {\n      staticClass: \"img-box\",\n      class: {\n        active: item === _vm.pickedItem\n      },\n      on: {\n        \"click\": function($event) {\n          _vm.pick(item)\n        }\n      }\n    }, [_c('img', {\n      attrs: {\n        \"src\": item.img,\n        \"alt\": item.value\n      }\n    }), _vm._v(\" \"), _c('i', [_vm._v(_vm._s(item.acc))])])\n  })), _vm._v(\" \"), _c('div', {\n    directives: [{\n      name: \"show\",\n      rawName: \"v-show\",\n      value: (_vm.pickedItem),\n      expression: \"pickedItem\"\n    }],\n    staticClass: \"confirm\"\n  }, [_vm._m(0), _vm._v(\" \"), _c('canvas', {\n    ref: \"cvs\"\n  }), _vm._v(\" \"), _c('div', {\n    staticClass: \"desc\"\n  }, [_c('div', [_vm._v(\"字符 \" + _vm._s(_vm.pickedItem && _vm.pickedItem.value))]), _vm._v(\" \"), _c('div', [_vm._v(\"符合率 \" + _vm._s(_vm.pickedItem && _vm.pickedItem.acc))])]), _vm._v(\" \"), _c('div', {\n    staticClass: \"bottom-btn-group\"\n  }, [_c('button', {\n    on: {\n      \"click\": _vm.confirm\n    }\n  }, [_vm._v(\"就他了\")]), _vm._v(\" \"), _c('button', {\n    on: {\n      \"click\": _vm.reset\n    }\n  }, [_vm._v(\"还是算了\")])])]), _vm._v(\" \"), _c('div', {\n    staticClass: \"btn\",\n    on: {\n      \"click\": _vm.custom\n    }\n  }, [_vm._v(\"这里没有朕想要的\")])])\n},staticRenderFns: [function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('ul', {\n    staticClass: \"tips\"\n  }, [_c('li', [_vm._v(\"你画的区域\")]), _vm._v(\" \"), _c('li', [_vm._v(\"字符的区域\")]), _vm._v(\" \"), _c('li', [_vm._v(\"重叠的区域\")])])\n}]}\n\n/***/ }),\n/* 33 */\n/***/ (function(module, exports) {\n\nmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    attrs: {\n      \"id\": \"home\"\n    }\n  }, [_c('canvas', {\n    ref: \"cvs\"\n  }), _vm._v(\" \"), _c('p', {\n    attrs: {\n      \"id\": \"msg\"\n    }\n  }, [_vm._v(_vm._s(_vm.msg))]), _vm._v(\" \"), _c('div', {\n    directives: [{\n      name: \"show\",\n      rawName: \"v-show\",\n      value: (_vm.state === 2),\n      expression: \"state === 2\"\n    }],\n    attrs: {\n      \"id\": \"match\"\n    }\n  }, [_c('canvas', {\n    ref: \"match\"\n  }), _vm._v(\" \"), _c('img', {\n    ref: \"img\",\n    attrs: {\n      \"src\": _vm.imgSrc,\n      \"alt\": \"img\"\n    }\n  })]), _vm._v(\" \"), _c('div', {\n    directives: [{\n      name: \"show\",\n      rawName: \"v-show\",\n      value: (_vm.state === 2),\n      expression: \"state === 2\"\n    }],\n    staticClass: \"bottom-btn-group\"\n  }, [_c('button', {\n    on: {\n      \"click\": _vm.confirm\n    }\n  }, [_vm._v(\"是\")]), _vm._v(\" \"), _c('button', {\n    on: {\n      \"click\": _vm.reset\n    }\n  }, [_vm._v(\"否\")])])])\n},staticRenderFns: []}\n\n/***/ })\n],[15]);\n\n\n// WEBPACK FOOTER //\n// static/js/app.73e36811e63841ca7d5a.js","const config = {\n  pen: {\n    size: 10,\n    fillStyle: '#000'\n  },\n  canvas: {\n    width: 200,\n    height: 200,\n    size: window.innerWidth > 400 ? 400 : window.innerWidth\n  },\n  grid: 32,\n  like: 0.1,\n  accept: 0.6,\n  grayThreshold: 128\n}\n\nconst fontLib = []\nconst userDraw = {}\n\nexports.config = config\nexports.fontLib = fontLib\nexports.userDraw = userDraw\n\n/**\n * grid data\n * @typedef {Array} GridData\n *\n */\n\n/**\n * convert ImageData into gray Array\n * @param {Uint8ClampedArray} data\n * @return {Array}\n */\nexports.convertImageData = function (data) {\n  const arr = []\n  for (let i = 0; i < data.length; i += 4) {\n    if (data[i + 3] === 0) {\n      arr.push(0)\n      continue\n    }\n    if ((data[i] + data[i + 1] + data[i + 2]) > config.grayThreshold * 3) {\n      arr.push(0)\n    } else {\n      arr.push(1)\n    }\n  }\n  return arr\n}\n\nexports.compareArray = function (a, b) {\n  let matched = 0\n  a.forEach((v, i) => {\n    if (v === 0 && b[i] === 0) {\n      return\n    }\n    if (Math.abs(v - b[i]) < config.like) {\n      matched++\n    }\n  })\n  const validPoint = a.filter(v => v > 0).length + b.filter(v => v > 0).length\n  return parseFloat(matched / validPoint).toFixed(4)\n}\n\nexports.combineArray = function (a, b, acc) {\n  acc = acc || 0.5\n  const arr = []\n  a.forEach((v, i) => {\n    arr.push(v * (1 - acc) + b[i] * acc)\n  })\n  return arr\n}\n\n/**\n * set canvas size\n * @param {Element} cvs\n * @param {Number} size\n */\nexports.setSize = function (cvs, size) {\n  cvs.width = size * window.devicePixelRatio\n  cvs.height = size * window.devicePixelRatio\n  cvs.style.width = size + 'px'\n  cvs.style.height = size + 'px'\n}\n\n/**\n * clear canvas\n * @param {Element} cvs\n */\nexports.clearCanvas = function (cvs) {\n  cvs.getContext('2d').clearRect(0, 0, cvs.width, cvs.height)\n}\n\n/**\n * add font to fontLib\n * @param {String|Number} str\n * @param {Object} fontStyle\n */\nexports.addFont = function (str, font) {\n  if (this._canvas === undefined) {\n    this._canvas = document.createElement('canvas')\n  }\n  const cvs = this._canvas\n  this.setSize(cvs, config.grid * 4)\n  const ctx = cvs.getContext('2d')\n\n  this.clearCanvas(cvs)\n  ctx.font = `200 ${cvs.height / 2}px ${font}`\n  ctx.textAlign = 'center'\n  ctx.fillStyle = '#000'\n  ctx.fillText(str, cvs.width / 2, cvs.height / 2)\n\n  const area = this.getAdjustArea(cvs)\n  const data = this.getGridData(cvs, area)\n\n  this.setSize(cvs, area.size)\n  this.drawArea({\n    cvs,\n    data,\n    area: { x: 0, y: 0, size: area.size * window.devicePixelRatio },\n    style: v => `rgba(0, 0, 0, ${v})`\n  })\n\n  fontLib.push({\n    value: str,\n    data,\n    img: cvs.toDataURL(),\n    size: area.size\n  })\n}\n\n/**\n * add custom font to fontLib\n * @param {String} value\n */\nexports.addCustomFont = function (value) {\n  const cvs = this._canvas\n  const data = userDraw.data\n  this.setSize(cvs, config.canvas.size)\n  this.clearCanvas(cvs)\n  this.drawArea({\n    cvs,\n    data,\n    area: { x: 0, y: 0, size: this._canvas.width },\n    style: v => `rgba(0, 0, 0, ${v})`\n  })\n\n  fontLib.push({\n    value,\n    data,\n    img: cvs.toDataURL(),\n    size: config.canvas.size\n  })\n}\n\nexports.fixFont = function (fontLibItem, acc) {\n  const data = this.combineArray(fontLibItem.data, userDraw.data, acc)\n  this.setSize(this._canvas, fontLibItem.size)\n  this.clearCanvas(this._canvas)\n  this.drawArea({\n    cvs: this._canvas,\n    data,\n    area: { x: 0, y: 0, size: this._canvas.width },\n    style: v => `rgba(0, 0, 0, ${v})`\n  })\n  fontLibItem.data = this.getAdjustGridData(this._canvas)\n  this.drawArea({\n    cvs: this._canvas,\n    data: fontLibItem.data,\n    area: { x: 0, y: 0, size: this._canvas.width },\n    style: v => `rgba(0, 0, 0, ${v})`\n  })\n  fontLibItem.img = this._canvas.toDataURL()\n}\n\n/**\n * drawGridData\n * @param {Element} cvs\n * @param {GridData} data\n * @param {{X, Y, size}} area\n */\nexports.drawArea = function ({ cvs, data, area, style, compare }) {\n  const ctx = cvs.getContext('2d')\n  this.clearCanvas(cvs)\n  const step = area.size / config.grid\n  for (let y = 0; y < config.grid; y++) {\n    for (let x = 0; x < config.grid; x++) {\n      const index = x + y * config.grid\n      if (compare) {\n        ctx.fillStyle = style(data[index], compare[index])\n      } else {\n        ctx.fillStyle = style(data[index])\n      }\n      ctx.fillRect(area.x + x * step, area.x + y * step, step, step)\n    }\n  }\n}\n\n/**\n * drawAreaBorder\n * @param {Element} cvs\n * @param {{X, Y, size}} area\n */\nexports.drawAreaBorder = function ({ cvs, area, style }) {\n  const ctx = cvs.getContext('2d')\n  ctx.strokeStyle = style\n  ctx.lineWidth = 1\n  ctx.strokeRect(area.x, area.y, area.size, area.size)\n}\n\n/**\n * detect text area from canvas\n * @param {Element} cvs\n * @return {{ x, y, size }}\n */\nexports.getDetectArea = function (cvs) {\n  const imageData = cvs.getContext('2d').getImageData(0, 0, cvs.width, cvs.height)\n  const arr = this.convertImageData(imageData.data)\n  const rect = {}\n\n  arr.forEach((v, i) => {\n    if (v) {\n      const y = Math.floor(i / cvs.width)\n      const x = Math.floor(i % cvs.width)\n\n      if (rect.XStart === undefined) {\n        rect.XStart = x\n        rect.XEnd = x\n        rect.YStart = y\n        rect.YEnd = y\n        return\n      }\n\n      if (x < rect.XStart) {\n        rect.XStart = x\n      }\n\n      if (x > rect.XEnd) {\n        rect.XEnd = x\n      }\n\n      if (y < rect.YStart) {\n        rect.YStart = y\n      }\n\n      if (y > rect.YEnd) {\n        rect.YEnd = y\n      }\n    }\n  })\n\n  const XOffset = rect.XEnd - rect.XStart\n  const YOffset = rect.YEnd - rect.YStart\n\n  if (YOffset >= XOffset) {\n    rect.y = rect.YStart\n    rect.x = Math.floor(rect.XStart - (YOffset - XOffset) / 2)\n    rect.size = YOffset\n  }\n\n  if (YOffset < XOffset) {\n    rect.x = rect.XStart\n    rect.y = Math.floor(rect.YStart - (XOffset - YOffset) / 2)\n    rect.size = XOffset\n  }\n\n  return rect\n}\n\n/**\n * adjust area to grid size\n * @param {{ x, y, size }} rect\n * @return {{ x, y, size }}\n */\nexports.adjustArea = function (rect) {\n  const offset = rect.size % config.grid\n  if (offset === 0) {\n    return rect\n  }\n\n  const toFixed = config.grid - offset\n  const half = Math.floor(toFixed / 2)\n\n  return {\n    x: rect.x - half,\n    y: rect.y - half,\n    size: rect.size + toFixed\n  }\n}\n\n/**\n * detect text area from canvas (adjusted)\n * @param {Element} cvs\n * @return {{ x, y, size }}\n */\nexports.getAdjustArea = function (cvs) {\n  return this.adjustArea(this.getDetectArea(cvs))\n}\n\n/**\n * get grid data\n * @param {Element} cvs\n * @param {{ x, y, size }} area\n * @return {Array}\n */\nexports.getGridData = function (cvs, area) {\n  const imageData = cvs.getContext('2d').getImageData(area.x, area.y, area.size, area.size)\n  const arr = this.convertImageData(imageData.data)\n  const size = area.size\n  const grid = config.grid\n  const step = size / grid\n  const gridData = []\n  for (let x = 0; x < grid; x++) {\n    for (let y = 0; y < grid; y++) {\n      const px = []\n      for (let xx = 0; xx < step; xx++) {\n        for (let yy = 0; yy < step; yy++) {\n          px.push(arr[y * step + x * size * step + yy + xx * size])\n        }\n      }\n      const percent = px.filter(p => !!p).length / px.length\n      gridData[y + x * grid] = percent > config.accept ? percent : 0\n    }\n  }\n  return gridData\n}\n\nexports.getAdjustGridData = function (cvs) {\n  const area = this.getAdjustArea(cvs)\n  return this.getGridData(cvs, area)\n}\n\n/**\n * init fontLib with 0-9 a-z\n */\nexports.initFontLib = function () {\n  if (fontLib.length) { return }\n  for (let i = 48; i < 91; i++) {\n    if (i > 57 && i < 65) {\n      continue\n    }\n    this.addFont(String.fromCharCode(i), `sans-serif`)\n  }\n}\n\n/**\n * find best match font and save user data\n * @param {Array} data\n */\nexports.findMatch = function (data) {\n  fontLib.forEach(font => {\n    font.acc = this.compareArray(data, font.data)\n  })\n  userDraw.data = data\n  fontLib.sort((a, b) => b.acc - a.acc)\n  return fontLib[0]\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib.js","const lib = require('./lib')\nconst { config } = lib\n\nexport default class Element {\n  constructor (cvs, size = config.canvas.size, canDraw = true) {\n    if (cvs === undefined) {\n      cvs = document.createElement('canvas')\n    }\n    this.cvs = cvs\n    this.size = size\n    this.canDraw = canDraw\n    this.callback = {}\n    this.init(cvs)\n  }\n\n  init (cvs) {\n    lib.setSize(cvs, this.size)\n    if (!this.canDraw) { return }\n    this.addEvent(['mousedown', 'touchstart'], this.drawStart)\n    this.addEvent(['mouseup', 'mouseleave', 'mouseenter', 'touchend'], this.drawEnd)\n    this.addEvent(['mousemove', 'touchmove'], this.drawing)\n  }\n\n  addEvent (arr, fn) {\n    arr.forEach(name => {\n      this.cvs.addEventListener(name, e => {\n        fn.call(this, e)\n        e.preventDefault()\n      })\n    })\n  }\n\n  drawing (e) {\n    if (!this._line) {\n      return\n    }\n    clearTimeout(this._afterDraw)\n    if (e.touches && e.touches[0]) {\n      e.offsetX = e.touches[0].pageX\n      e.offsetY = e.touches[0].pageY\n    }\n    this._line.add(e.offsetX, e.offsetY)\n  }\n\n  drawStart () {\n    this.stashPop()\n    this._line = new Line(this.cvs)\n  }\n\n  drawEnd () {\n    this._line = null\n    this._afterDraw = setTimeout(this.afterDraw.bind(this), 600)\n  }\n\n  afterDraw () {\n    this.stash()\n    const area = this.getAdjustDetectArea()\n    const data = lib.getGridData(this.cvs, area)\n    this.callback.finish && this.callback.finish(data)\n    lib.drawAreaBorder({\n      cvs: this.cvs,\n      area,\n      style: 'rgba(255, 0, 0, 0.5)'\n    })\n  }\n\n  stash () {\n    this._snapshot = this.cvs.getContext('2d').getImageData(0, 0, this.cvs.width, this.cvs.height)\n  }\n\n  stashPop () {\n    if (!this._snapshot) { return }\n    this.cvs.getContext('2d').putImageData(this._snapshot, 0, 0)\n    this._snapshot = null\n  }\n\n  clear () {\n    this._snapshot = null\n    lib.clearCanvas(this.cvs)\n  }\n\n  getDetectArea () {\n    return lib.getDetectArea(this.cvs)\n  }\n\n  getAdjustDetectArea () {\n    return lib.getAdjustArea(this.cvs)\n  }\n}\n\nclass Line {\n  constructor (cvs) {\n    this.cvs = cvs\n    this.ctx = cvs.getContext('2d')\n    this.ratio = window.devicePixelRatio\n  }\n\n  add (x, y) {\n    x *= this.ratio\n    y *= this.ratio\n    if (this._last) {\n      this.drawLine(this._last, { x, y })\n    }\n    this.drawArc(x, y)\n    this._last = { x, y }\n  }\n\n  drawLine (p, n) {\n    this.ctx.beginPath()\n    this.ctx.moveTo(p.x, p.y)\n    this.ctx.lineTo(n.x, n.y)\n    this.ctx.lineWidth = config.pen.size * 2\n    this.ctx.strokeStyle = config.pen.fillStyle\n    this.ctx.stroke()\n  }\n\n  drawArc (x, y) {\n    this.ctx.beginPath()\n    this.ctx.arc(x, y, config.pen.size, 0, Math.PI * 2)\n    this.ctx.fillStyle = config.pen.fillStyle\n    this.ctx.fill()\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/Canvas.js","var Component = require(\"!../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./home.vue\"),\n  /* template */\n  require(\"!!../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-9c316dee\\\"}!../node_modules/vue-loader/lib/selector?type=template&index=0!./home.vue\"),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/home.vue\n// module id = 11\n// module chunks = 1","var Component = require(\"!../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./identify.vue\"),\n  /* template */\n  require(\"!!../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-410d0bb6\\\"}!../node_modules/vue-loader/lib/selector?type=template&index=0!./identify.vue\"),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/identify.vue\n// module id = 12\n// module chunks = 1","// The Vue build version to load with the `import` command\n// (runtime-only or standalone) has been set in webpack.base.conf with an alias.\nimport Vue from 'vue'\nimport VueRouter from 'vue-router'\n\nimport home from './home'\nimport identify from './identify'\n\nimport 'normalize.css'\nimport './index.less'\n\nVue.config.productionTip = false\n\nVue.use(VueRouter)\n\nconst routes = [\n  { path: '/', component: home },\n  { path: '/identify', component: identify }\n]\n\nconst router = new VueRouter({\n  routes\n})\n\n/* eslint-disable no-new */\nnew Vue({\n  router\n}).$mount('#app')\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js","<template>\n  <div id=\"home\">\n    <canvas ref=\"cvs\"></canvas>\n    <p id=\"msg\">{{msg}}</p>\n    <div id=\"match\" v-show=\"state === 2\">\n      <canvas ref=\"match\"></canvas>\n      <img ref=\"img\" :src=\"imgSrc\" alt=\"img\">\n    </div>\n    <div class=\"bottom-btn-group\" v-show=\"state === 2\">\n      <button @click=\"confirm\">是</button>\n      <button @click=\"reset\">否</button>\n    </div>\n  </div>\n</template>\n\n<script>\n  import Canvas from './Canvas'\n  import lib from './lib'\n\n  const config = lib.config\n\n  const STATE_MSG = {\n    0: '正在初始化数据...',\n    1: '在上方画布开始绘画',\n    2: '识别是否准确？'\n  }\n\n  export default {\n    data () {\n      return {\n        state: 0,\n        fontLib: lib.fontLib,\n        imgSrc: ''\n      }\n    },\n    computed: {\n      msg () {\n        if (this.state === 2) {\n          return `「 ${this.fontLib[0].value} 」 ` + STATE_MSG[this.state]\n        }\n        return STATE_MSG[this.state]\n      }\n    },\n    created () {\n      setTimeout(() => {\n        lib.initFontLib()\n        this.state = 1\n      }, 0)\n    },\n    mounted () {\n      this.$nextTick(this.init)\n    },\n    methods: {\n      init () {\n        this._canvas = new Canvas(this.$refs.cvs)\n        this._match = new Canvas(this.$refs.match, config.grid * 4, false)\n\n        this._canvas.callback.finish = data => {\n          this.state = 2\n          const matched = lib.findMatch(data)\n          lib.setSize(this.$refs.img, config.grid * 4)\n          this.imgSrc = matched.img\n\n          lib.drawArea({\n            cvs: this.$refs.match,\n            data: data,\n            area: { x: 0, y: 0, size: this.$refs.match.width },\n            compare: matched.data,\n            style: (a, b) => {\n              if (a === 0 && b > 0) {\n                return `rgba(255, 0, 0, ${b / 2})`\n              }\n              if (b === 0 && a > 0) {\n                return `rgba(0, 0, 0, ${a})`\n              }\n              if (a === 0 && b === 0) {\n                return '#fff'\n              }\n              return `rgba(0, 255, 0, ${1 - Math.abs(a - b)})`\n            }\n          })\n        }\n      },\n\n      reset () {\n        this.state = 1\n        this._canvas.clear()\n        this.$router.push({ path: '/identify' })\n      },\n\n      confirm () {\n        this.state = 1\n        this._canvas.clear()\n        lib.fixFont(this.fontLib[0], 0.1)\n      }\n    }\n  }\n</script>\n\n\n\n// WEBPACK FOOTER //\n// home.vue?95e9456c","<template>\n  <div id=\"Identify\">\n    <div class=\"title\"><router-link to=\"/\">返回</router-link>选择你想画的图形</div>\n    <div class=\"imgs\">\n      <div v-for=\"item in list\" class=\"img-box\" @click=\"pick(item)\" :class=\"{ active: item === pickedItem }\">\n        <img :src=\"item.img\" :alt=\"item.value\">\n        <i>{{item.acc}}</i>\n      </div>\n    </div>\n    <div class=\"confirm\" v-show=\"pickedItem\">\n      <ul class=\"tips\">\n        <li>你画的区域</li>\n        <li>字符的区域</li>\n        <li>重叠的区域</li>\n      </ul>\n      <canvas ref=\"cvs\"></canvas>\n      <div class=\"desc\">\n        <div>字符 {{pickedItem && pickedItem.value}}</div>\n        <div>符合率 {{pickedItem && pickedItem.acc}}</div>\n      </div>\n      <div class=\"bottom-btn-group\">\n        <button @click=\"confirm\">就他了</button>\n        <button @click=\"reset\">还是算了</button>\n      </div>\n    </div>\n    <div class=\"btn\" @click=\"custom\">这里没有朕想要的</div>\n  </div>\n</template>\n\n<script>\n  import lib from './lib'\n  import Canvas from './Canvas'\n\n  export default {\n    data () {\n      return {\n        list: lib.fontLib,\n        pickedItem: null\n      }\n    },\n\n    methods: {\n      pick (item) {\n        if (this.pickedItem === item) {\n          this.pickedItem = null\n        } else {\n          this.pickedItem = item\n          const cvs = new Canvas(this.$refs.cvs, 200)\n          lib.drawArea({\n            cvs: cvs.cvs,\n            data: lib.userDraw.data,\n            compare: item.data,\n            area: { x: 0, y: 0, size: cvs.cvs.width },\n            style: (a, b) => {\n              if (a === 0 && b > 0) {\n                return `rgba(255, 0, 0, ${b / 2})`\n              }\n              if (b === 0 && a > 0) {\n                return `rgba(0, 0, 0, ${a})`\n              }\n              if (a === 0 && b === 0) {\n                return '#fff'\n              }\n              return `rgba(0, 255, 0, ${1 - Math.abs(a - b)})`\n            }\n          })\n        }\n      },\n      confirm () {\n        lib.fixFont(this.pickedItem, 0.5)\n        this.pickedItem = null\n        this.$router.push({ path: '/' })\n      },\n      reset () {\n        this.pickedItem = null\n      },\n      custom () {\n        lib.addCustomFont(window.prompt('给你画的东西起个名字吧'))\n      }\n    }\n  }\n</script>\n\n\n\n// WEBPACK FOOTER //\n// identify.vue?73679b74","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    attrs: {\n      \"id\": \"Identify\"\n    }\n  }, [_c('div', {\n    staticClass: \"title\"\n  }, [_c('router-link', {\n    attrs: {\n      \"to\": \"/\"\n    }\n  }, [_vm._v(\"返回\")]), _vm._v(\"选择你想画的图形\")], 1), _vm._v(\" \"), _c('div', {\n    staticClass: \"imgs\"\n  }, _vm._l((_vm.list), function(item) {\n    return _c('div', {\n      staticClass: \"img-box\",\n      class: {\n        active: item === _vm.pickedItem\n      },\n      on: {\n        \"click\": function($event) {\n          _vm.pick(item)\n        }\n      }\n    }, [_c('img', {\n      attrs: {\n        \"src\": item.img,\n        \"alt\": item.value\n      }\n    }), _vm._v(\" \"), _c('i', [_vm._v(_vm._s(item.acc))])])\n  })), _vm._v(\" \"), _c('div', {\n    directives: [{\n      name: \"show\",\n      rawName: \"v-show\",\n      value: (_vm.pickedItem),\n      expression: \"pickedItem\"\n    }],\n    staticClass: \"confirm\"\n  }, [_vm._m(0), _vm._v(\" \"), _c('canvas', {\n    ref: \"cvs\"\n  }), _vm._v(\" \"), _c('div', {\n    staticClass: \"desc\"\n  }, [_c('div', [_vm._v(\"字符 \" + _vm._s(_vm.pickedItem && _vm.pickedItem.value))]), _vm._v(\" \"), _c('div', [_vm._v(\"符合率 \" + _vm._s(_vm.pickedItem && _vm.pickedItem.acc))])]), _vm._v(\" \"), _c('div', {\n    staticClass: \"bottom-btn-group\"\n  }, [_c('button', {\n    on: {\n      \"click\": _vm.confirm\n    }\n  }, [_vm._v(\"就他了\")]), _vm._v(\" \"), _c('button', {\n    on: {\n      \"click\": _vm.reset\n    }\n  }, [_vm._v(\"还是算了\")])])]), _vm._v(\" \"), _c('div', {\n    staticClass: \"btn\",\n    on: {\n      \"click\": _vm.custom\n    }\n  }, [_vm._v(\"这里没有朕想要的\")])])\n},staticRenderFns: [function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('ul', {\n    staticClass: \"tips\"\n  }, [_c('li', [_vm._v(\"你画的区域\")]), _vm._v(\" \"), _c('li', [_vm._v(\"字符的区域\")]), _vm._v(\" \"), _c('li', [_vm._v(\"重叠的区域\")])])\n}]}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler?{\"id\":\"data-v-410d0bb6\"}!./~/vue-loader/lib/selector.js?type=template&index=0!./src/identify.vue\n// module id = 32\n// module chunks = 1","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    attrs: {\n      \"id\": \"home\"\n    }\n  }, [_c('canvas', {\n    ref: \"cvs\"\n  }), _vm._v(\" \"), _c('p', {\n    attrs: {\n      \"id\": \"msg\"\n    }\n  }, [_vm._v(_vm._s(_vm.msg))]), _vm._v(\" \"), _c('div', {\n    directives: [{\n      name: \"show\",\n      rawName: \"v-show\",\n      value: (_vm.state === 2),\n      expression: \"state === 2\"\n    }],\n    attrs: {\n      \"id\": \"match\"\n    }\n  }, [_c('canvas', {\n    ref: \"match\"\n  }), _vm._v(\" \"), _c('img', {\n    ref: \"img\",\n    attrs: {\n      \"src\": _vm.imgSrc,\n      \"alt\": \"img\"\n    }\n  })]), _vm._v(\" \"), _c('div', {\n    directives: [{\n      name: \"show\",\n      rawName: \"v-show\",\n      value: (_vm.state === 2),\n      expression: \"state === 2\"\n    }],\n    staticClass: \"bottom-btn-group\"\n  }, [_c('button', {\n    on: {\n      \"click\": _vm.confirm\n    }\n  }, [_vm._v(\"是\")]), _vm._v(\" \"), _c('button', {\n    on: {\n      \"click\": _vm.reset\n    }\n  }, [_vm._v(\"否\")])])])\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler?{\"id\":\"data-v-9c316dee\"}!./~/vue-loader/lib/selector.js?type=template&index=0!./src/home.vue\n// module id = 33\n// module chunks = 1"],"sourceRoot":""}